<!DOCTYPE html>
<html>

<head>

  <!-- Veena's testing Area for materialize -->
 
<link rel = "stylesheet"
  href = "https://cdnjs.cloudflare.com/ajax/libs/materialize/0.97.3/css/materialize.min.css">
<script type = "text/javascript"
  src = "https://code.jquery.com/jquery-2.1.1.min.js"></script>           
<script src = "https://cdnjs.cloudflare.com/ajax/libs/materialize/0.97.3/js/materialize.min.js">
</script> 

<!-- =============================================== -->
  <!--Import Google Icon Font-->
  <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
  <script defer src="https://use.fontawesome.com/releases/v5.0.6/js/all.js"></script>

  <!--Import materialize.css-->
  <link type="text/css" rel="stylesheet" href="css/materialize.min.css" media="screen,projection" />
  <link type="text/css" rel="stylesheet" href="css/main.css" />

  <!--Let browser know website is optimized for mobile-->
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Your Profile</title>
</head>

<body>
<!-- Header -->
<header class="profile">
  <nav id="profile-nav">
    <div class="container">
      <div class="nav-wrapper">
        <a href="index.html" class="brand-logo">RCB 18</a>
        <a href="#" data-activates="mobile-nav" class="button-collapse">
          <i class="fa fa-bars"></i>
        </a>
        <ul class="right hide-on-med-and-down">
         
          <li>
            <a href="https://facebook.com">
              <i class="fab fa-facebook"></i>
            </a>
          </li>
          <li>
            <a href="https://twitter.com">
              <i class="fab fa-twitter"></i>
            </a>
          </li>
          <li>
            <a href="https://instagram.com">
              <i class="fab fa-instagram"></i>
            </a>
          </li>
          <li>
            Welcome, <span id="userName"></span>
          </li>
          <li>
              <a class="logout-link" href="index.html">LOGOUT</a>
            </li>
        </ul>
        <ul class="side-nav" id="mobile-nav">
          <h4 class="teal-text text-darken-4 center">RCB Network</h4>
          <li>
            <div class="divider"></div>
          </li>
          <li>
            <a href="index.html">
              <i class="fa fa-home grey-text text-darken-4"></i> Home</a>
          </li>
          <li>
            <a href="portfolio.html">
              <i class="fa fa-users grey-text text-darken-4"></i> Sign Up</a>
          </li>
          <li>
            <div class="divider"></div>
          </li>
          <li>
            <a href="index.html" class="btn teal">Login</a>
          </li>
        </ul>
      </div>
    </div>
  </nav>
</header>
<br>
<!-- veena's testing area STARTS -->
<div class="row">
    <form class="col s12 m6 offset-m3">
      <input placeholder="Enter profession" id="profession-name" type="text" class="validate"> 
      <span>
      <a class="btn waves-effect waves-light waves-green" href="#" id="searchIcon"> <i class="material-icons">search</i></a>
    </span>
    </form>
  </div>

  <!-- <div class="row">
    <form class="col m12">
        <div class="row">
            <div class="input-field col s2"></div>
            
            <div class="input-field col s6"> -->
                <!-- <label>Materialize Select</label> -->
                <!-- <select>
                    <option value="" disabled="disabled" selected="selected">Choose your option</option>
                    <option value="1">Option 1</option>
                    <option value="2">Option 2</option>
                    <option value="3">Option 3</option>
                </select>
            </div>
            <div class="input-field col s2"></div>
        </div>
    </form> -->
  <!-- VEENA'S TESTING AREA ENDS -->
    
    <div class="container">
        
    <!-- Profile Image -->
    <div class="row">
      <h2 class="grey-text center-align" id="header"></h2>      
      <p>
        <a href="#" id="Profilepage"></a>
      </p>
    </div>
    <div id="cd" class="row ">
              
    </div>

    <!-- Profile Image -->
    <div id="userprofile">
        <div class="row card" id="membercard">
            <div class="col s6 m3">
              <div class="card">
                <div class="card-image">
                  <img id="userProfileImage" src="img/profile-avatar.jpg">
                </div>                
                <div class="card-action">
                  <a href="#" id="change_profile_picture">Change Profile Picture</a>
                </div>
                <!-- Add the form to change profile picture here -->
                <div id="uploadProfileDiv" class="hide" >
                  <form ref='uploadForm' id='uploadForm' 
                    action='/uploadProfilePhoto' 
                    method='post' 
                    encType="multipart/form-data">
                    <input type="file" name="profileImage" />
                    <input class="btn" id="uploadProfileImage" type='submit' value='Upload Profile Photo' />
                  </form>
                </div>
              </div>
            </div>
          
          
            <div class="col s12 m2 profile-user">
              <p><a id="delprofile" href="#">Delete Profile</a></p>
            </div>
      
            <!-- About Me Section -->
            <div class="col s12 m8">
              <div class="card grey darken-4">
                <div class="card-content white-text">
                  
                    <h5><span id="first_name"></span> <span id="last_name"></span></h5> 
                    <p>Profession</p>
                  
                </div>
              </div>
            </div>
           
              
              <div class="col s3">
                <div id="cd" class="row">
                  <!-- All members searched will show up here -->
                </div>
            </div>
        </div>
    </div>
<div id ="nodata" class="hide">OOPS! SORRY.  WE DON'T HAVE ANY MEMBERS RELATED TO YOUR SEARCH</div>

  </div>

  <!--Import jQuery before materialize.js-->
  <script type="text/javascript " src="https://code.jquery.com/jquery-3.2.1.min.js "></script>  
  <script type="text/javascript " src="js/materialize.min.js "></script>
  <script>
    $(document).ready(function(){
    $('.materialboxed').materialbox();
    $('.dropdown-button').dropdown({
        constrainWidth: false,
        hover: true,
        belowOrigin: true,
        alignment: 'left'
      });

      // JAVASCRIPT START HERE //
      $(".button-collapse").sideNav();
    // Baraka Test
    // Get the user's data from local storage:
    var userData = JSON.parse(localStorage.getItem("rcbUserData"));
    // Update the template with the logged in user's data
    $("#userName, #first_name").text(userData.first_name);
    $("#last_name").text(userData.last_name);
    $("#userProfileImage").attr("src",`/profileImages/${userData.photo}`);
    // Remove the data in local storage when user logs out
    $(".logout-link").click(function(){
      localStorage.removeItem("rcbUserData");
    });
    $("#uploadProfileImage").click(function(e){
      //e.preventDefault();
      console.log("hi front end")      
      $.post("/sendPhotoData", userData).then(function (dbResults) {
        window.location.replace("/index.html");
        //console.log(dbResults);
      });
    });
    var isShowing = false;
    $("#change_profile_picture").click(function(){
      alert("After you upload the picture, first time users MUST click logout, then login for these changes to take effect!");
      if(!isShowing){
        $("#uploadProfileDiv").removeClass("hide");
        isShowing = true;
      }else{
        $("#uploadProfileDiv").addClass("hide");
        isShowing = false;
      }
      
    });
     //DELETE PROFILE
$('#delprofile').click(function(event){
	event.preventDefault();
	console.log(userData.id);
	// var listItemData = $(this).parent("td").parent("tr").data("author");
    // var id = listItemData.id;
    $.ajax({
      method: "DELETE",
      url: "/delete",
      data: userData 
    })
    .then(function(result){
      console.log(result);
    });
  })
  });

// Veena;s testing area
  $(document).ready(function() {
    $('select').material_select();
  });
 
  </script>
  
  <script src="js/search.js"></script>
  <script src="js/ajax.js"></script>


</body>
</html>